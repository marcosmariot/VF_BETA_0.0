"use strict";(()=>{var e={};e.id=679,e.ids=[679],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},38381:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>y,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var r={};o.r(r),o.d(r,{GET:()=>u,POST:()=>p});var a=o(49303),i=o(88716),s=o(60670),n=o(87070);async function p(e){try{let{workflow:t,inputs:o,textOutputEnabled:r=!1}=await e.json(),a=process.env.COMFYUI_ENDPOINT||"http://localhost:8188",i=function(e,t){let o=JSON.parse(JSON.stringify(e));return t.forEach(({key:e,value:t})=>{let[r,a,i]=e.split("-");o[r]&&o[r].inputs&&(o[r].inputs[i]=t)}),o}(t,o),s=await fetch(`${a}/prompt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:i,client_id:Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)})});if(!s.ok)throw Error(`ComfyUI API error: ${s.statusText}`);let p=(await s.json()).prompt_id,u=await l(a,p);return n.NextResponse.json({success:!0,data:u})}catch(e){return console.error("ComfyUI API error:",e),n.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function l(e,t){let o=0;for(;o<60;)try{let r=await fetch(`${e}/history/${t}`),a=await r.json();if(a[t]&&a[t].status?.completed){let o=a[t].outputs,r=[];for(let t in o){let a=o[t];if(a.images)for(let t of a.images){let o=await fetch(`${e}/view?filename=${t.filename}&subfolder=${t.subfolder}&type=${t.type}`),a=await o.blob();r.push(a)}}return r}await new Promise(e=>setTimeout(e,5e3)),o++}catch(e){console.error("Error checking completion:",e),o++,await new Promise(e=>setTimeout(e,5e3))}throw Error("Timeout waiting for ComfyUI completion")}async function u(){try{return n.NextResponse.json({success:!0,workflows:[{id:"fashion-sketch",name:"Croqui de Moda",description:"Gera croquis profissionais de pe\xe7as de moda",category:"Design",inputs:[{key:"prompt",label:"Descri\xe7\xe3o da Pe\xe7a",type:"text",placeholder:"Ex: vestido longo floral, manga longa...",required:!0},{key:"style",label:"Estilo",type:"select",options:["Casual","Formal","Esportivo","Vintage"],required:!0}]},{id:"pattern-generation",name:"Gera\xe7\xe3o de Estampas",description:"Cria estampas \xfanicas para tecidos",category:"Estampas",inputs:[{key:"pattern_type",label:"Tipo de Estampa",type:"select",options:["Floral","Geom\xe9trica","Animal Print","Abstrata"],required:!0},{key:"colors",label:"Paleta de Cores",type:"text",placeholder:"Ex: azul, branco, dourado",required:!0}]},{id:"model-visualization",name:"Visualiza\xe7\xe3o em Modelo",description:"Visualiza pe\xe7as em modelos virtuais",category:"Visualiza\xe7\xe3o",inputs:[{key:"garment",label:"Pe\xe7a de Roupa",type:"image",required:!0},{key:"model_type",label:"Tipo de Modelo",type:"select",options:["Feminino","Masculino","Plus Size","Infantil"],required:!0}]}]})}catch(e){return console.error("Error fetching workflows:",e),n.NextResponse.json({success:!1,error:"Failed to fetch workflows"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/comfyui/route",pathname:"/api/comfyui",filename:"route",bundlePath:"app/api/comfyui/route"},resolvedPagePath:"/home/ubuntu/vertical-fashion-project/app/api/comfyui/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:f}=c,y="/api/comfyui/route";function h(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}},49303:(e,t,o)=>{e.exports=o(30517)}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[948,70],()=>o(38381));module.exports=r})();