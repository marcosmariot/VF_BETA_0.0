(()=>{var e={};e.id=343,e.ids=[343],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},49411:e=>{"use strict";e.exports=require("node:path")},58359:()=>{},93739:()=>{},84283:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>I,requestAsyncStorage:()=>x,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{GET:()=>p,POST:()=>d});var o=t(49303),i=t(88716),n=t(60670),a=t(87070),u=t(24910),c=t(85662);async function p(e){try{let{userId:r}=await (0,u.I)();if(!r)return a.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{searchParams:t}=new URL(e.url),s=parseInt(t.get("limit")||"20"),o=parseInt(t.get("offset")||"0"),i=await (0,c.C)(),{data:n,error:p}=await i.from("generation_history").select(`
        *,
        user_workflows (
          name,
          description
        )
      `).eq("user_id",r).order("created_at",{ascending:!1}).range(o,o+s-1);if(p)return console.error("Erro ao buscar hist\xf3rico:",p),a.NextResponse.json({error:"Erro interno do servidor"},{status:500});return a.NextResponse.json({history:n})}catch(e){return console.error("Erro na API de hist\xf3rico:",e),a.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}async function d(e){try{let{userId:r}=await (0,u.I)();if(!r)return a.NextResponse.json({error:"N\xe3o autorizado"},{status:401});let{workflow_id:t,input_data:s,output_data:o,status:i="completed"}=await e.json();if(!t||!s)return a.NextResponse.json({error:"Dados obrigat\xf3rios n\xe3o fornecidos"},{status:400});let n=await (0,c.C)(),{data:p,error:d}=await n.from("generation_history").insert({user_id:r,workflow_id:t,input_data:s,output_data:o,status:i}).select().single();if(d)return console.error("Erro ao salvar gera\xe7\xe3o:",d),a.NextResponse.json({error:"Erro ao salvar gera\xe7\xe3o"},{status:500});return await n.rpc("increment_generation_count",{user_id:r}),a.NextResponse.json({generation:p},{status:201})}catch(e){return console.error("Erro na API de hist\xf3rico:",e),a.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/user/history/route",pathname:"/api/user/history",filename:"route",bundlePath:"app/api/user/history/route"},resolvedPagePath:"/home/ubuntu/vertical-fashion-project/app/api/user/history/route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:m,serverHooks:h}=l,f="/api/user/history/route";function I(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},85662:(e,r,t)=>{"use strict";t.d(r,{C:()=>a});var s=t(72438),o=t(24910);let i="https://jwpzenydjjmfzybkfqff.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp3cHplbnlkamptZnp5YmtmcWZmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA1Njk4NDYsImV4cCI6MjA2NjE0NTg0Nn0.zlWSiktahVmSmz4uo3VAs0g90BQkEIjZ11fEmfIIXjU";(0,s.eI)(i,n);let a=async()=>{let{getToken:e}=await (0,o.I)(),r=await e({template:"supabase"});return console.log("Supabase Client: Token recebido do Clerk:",r?"Sim":"N\xe3o",r),(0,s.eI)(i,n,{global:{headers:{Authorization:`Bearer ${r}`}}})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,70,910,922],()=>t(84283));module.exports=s})();